"use strict";function _classCallCheck(a,b){if(!(a instanceof b))throw new TypeError("Cannot call a class as a function")}function _addEventListener(a,b,c){return _supportsAddEventListener?void a.addEventListener(b,c):void(_supportsAttachEvent&&(a.attachEvent("on"+b,function(a){return function(){c.call(a,window.event)}}(a)),a=null))}function _removeEventListener(a,b,c){return _supportsAddEventListener?void a.removeEventListener(b,c):void(_supportsAttachEvent&&a.detachEvent("on"+b,c))}function _isInsideViewport(a,b,c){function d(){return window.innerWidth||l.documentElement.clientWidth||document.body.clientWidth}function e(){return window.innerHeight||l.documentElement.clientHeight||document.body.clientHeight}function f(a){return a.getBoundingClientRect().top+m-l.documentElement.clientTop}function g(a){return a.getBoundingClientRect().left+n-l.documentElement.clientLeft}function h(){var d;return d=b===window?e()+m:f(b)+b.offsetHeight,d<=f(a)-c}function i(){var e;return e=b===window?d()+window.pageXOffset:g(b)+d(),e<=g(a)-c}function j(){var d;return d=b===window?m:f(b),d>=f(a)+c+a.offsetHeight}function k(){var d;return d=b===window?n:g(b),d>=g(a)+c+a.offsetWidth}var l,m,n;return l=a.ownerDocument,m=window.pageYOffset||l.body.scrollTop,n=window.pageXOffset||l.body.scrollLeft,!(h()||j()||i()||k())}function _now(){return(new Date).getTime()}function _merge_objects(a,b){var c,d={};for(c in a)a.hasOwnProperty(c)&&(d[c]=a[c]);for(c in b)b.hasOwnProperty(c)&&(d[c]=b[c]);return d}function _convertToArray(a){try{return Array.prototype.slice.call(a)}catch(e){var b,c=[],d=a.length;for(b=0;b<d;b++)c.push(a[b]);return c}}function _addClass(a,b){return _supportsClassList?void a.classList.add(b):void(a.className+=(a.className?" ":"")+b)}function _removeClass(a,b){return _supportsClassList?void a.classList.remove(b):void(a.className=a.className.replace(new RegExp("(^|\\s+)"+b+"(\\s+|$)")," ").replace(/^\s+/,"").replace(/\s+$/,""))}function _setSourcesForPicture(a,b){var c=a.parentElement;if("PICTURE"===c.tagName)for(var d=0;d<c.children.length;d++){var e=c.children[d];if("SOURCE"===e.tagName){var f=e.getAttribute("data-"+b);f&&e.setAttribute("srcset",f)}}}function _setSources(a,b,c){var d=a.tagName,e=a.getAttribute("data-"+c);if("IMG"===d){_setSourcesForPicture(a,b);var f=a.getAttribute("data-"+b);return f&&a.setAttribute("srcset",f),void(e&&a.setAttribute("src",e))}return"IFRAME"===d?void(e&&a.setAttribute("src",e)):void(a.style.backgroundImage="url("+e+")")}function _bind(a,b){return function(){return a.apply(b,arguments)}}var _typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(a){return typeof a}:function(a){return a&&"function"==typeof Symbol&&a.constructor===Symbol&&a!==Symbol.prototype?"symbol":typeof a},_createClass=function(){function a(a,b){for(var c=0;c<b.length;c++){var d=b[c];d.enumerable=d.enumerable||!1,d.configurable=!0,"value"in d&&(d.writable=!0),Object.defineProperty(a,d.key,d)}}return function(b,c,d){return c&&a(b.prototype,c),d&&a(b,d),b}}(),_defaultSettings={elements_selector:"img",container:window,threshold:300,throttle:50,data_src:"original",data_srcset:"original-set",class_loading:"loading",class_loaded:"loaded",skip_invisible:!0,callback_load:null,callback_error:null,callback_set:null,callback_processed:null},_supportsAddEventListener=!!window.addEventListener,_supportsAttachEvent=!!window.attachEvent,_supportsClassList=!!document.body.classList,LazyLoad=function(){function a(b){_classCallCheck(this,a),this._settings=_merge_objects(_defaultSettings,b),this._queryOriginNode=this._settings.container===window?document:this._settings.container,this._previousLoopTime=0,this._loopTimeout=null,this._handleScrollFn=_bind(this.handleScroll,this),_addEventListener(window,"resize",this._handleScrollFn),this.update()}return _createClass(a,[{key:"_showOnAppear",value:function(a){function b(){null!==c&&(c.callback_load&&c.callback_load(a),_removeClass(a,c.class_loading),_addClass(a,c.class_loaded),_removeEventListener(a,"load",b))}var c=this._settings;"IMG"!==a.tagName&&"IFRAME"!==a.tagName||(_addEventListener(a,"load",b),_addEventListener(a,"error",function(){_removeEventListener(a,"load",b),_removeClass(a,c.class_loading),c.callback_error&&c.callback_error(a)}),_addClass(a,c.class_loading)),_setSources(a,c.data_srcset,c.data_src),c.callback_set&&c.callback_set(a)}},{key:"_loopThroughElements",value:function(){var a=void 0,b=void 0,c=this._settings,d=this._elements,e=d?d.length:0,f=[];for(a=0;a<e;a++)b=d[a],c.skip_invisible&&null===b.offsetParent||_isInsideViewport(b,c.container,c.threshold)&&(this._showOnAppear(b),f.push(a),b.wasProcessed=!0);for(;f.length>0;)d.splice(f.pop(),1),c.callback_processed&&c.callback_processed(d.length);0===e&&this._stopScrollHandler()}},{key:"_purgeElements",value:function(){var a=void 0,b=void 0,c=this._elements,d=c.length,e=[];for(a=0;a<d;a++)b=c[a],b.wasProcessed&&e.push(a);for(;e.length>0;)c.splice(e.pop(),1)}},{key:"_startScrollHandler",value:function(){this._isHandlingScroll||(this._isHandlingScroll=!0,_addEventListener(this._settings.container,"scroll",this._handleScrollFn))}},{key:"_stopScrollHandler",value:function(){this._isHandlingScroll&&(this._isHandlingScroll=!1,_removeEventListener(this._settings.container,"scroll",this._handleScrollFn))}},{key:"handleScroll",value:function(){var a=void 0,b=void 0,c=void 0;this._settings&&(b=_now(),c=this._settings.throttle,0!==c?(a=c-(b-this._previousLoopTime),a<=0||a>c?(this._loopTimeout&&(clearTimeout(this._loopTimeout),this._loopTimeout=null),this._previousLoopTime=b,this._loopThroughElements()):this._loopTimeout||(this._loopTimeout=setTimeout(_bind(function(){this._previousLoopTime=_now(),this._loopTimeout=null,this._loopThroughElements()},this),a))):this._loopThroughElements())}},{key:"update",value:function(){this._elements=_convertToArray(this._queryOriginNode.querySelectorAll(this._settings.elements_selector)),this._purgeElements(),this._loopThroughElements(),this._startScrollHandler()}},{key:"destroy",value:function(){_removeEventListener(window,"resize",this._handleScrollFn),this._loopTimeout&&(clearTimeout(this._loopTimeout),this._loopTimeout=null),this._stopScrollHandler(),this._elements=null,this._queryOriginNode=null,this._settings=null}}]),a}();!function(a,b){"function"==typeof define&&define.amd?define([],b):"object"===("undefined"==typeof exports?"undefined":_typeof(exports))?module.exports=b():a.LazyLoad=b()}(window,function(){return LazyLoad});
//# sourceMappingURL=lazyload.min.js.map