!function(a,b){"function"==typeof define&&define.amd?define([],b):"object"==typeof exports?module.exports=b():a.LazyLoad=b()}(this,function(){class a{constructor(a){const b={elements_selector:"img",container:window,threshold:300,throttle:150,data_src:"original",data_srcset:"original-set",class_loading:"loading",class_loaded:"loaded",skip_invisible:!0,callback_load:null,callback_error:null,callback_set:null,callback_processed:null};this._settings=Object.assign({},b,a),this._queryOriginNode=this._settings.container===window?document:this._settings.container,this._previousLoopTime=0,this._loopTimeout=null,this._boundHandleScroll=this.handleScroll.bind(this),window.addEventListener("resize",this._boundHandleScroll),this.update()}_isInsideViewport(a,b,c){function d(){return window.innerWidth||h.documentElement.clientWidth||document.body.clientWidth}function e(){return window.innerHeight||h.documentElement.clientHeight||document.body.clientHeight}function f(a){return a.getBoundingClientRect().top+i-h.documentElement.clientTop}function g(a){return a.getBoundingClientRect().left+j-h.documentElement.clientLeft}let h,i,j;return h=a.ownerDocument,i=window.pageYOffset||h.body.scrollTop,j=window.pageXOffset||h.body.scrollLeft,!(function(){return(b===window?e()+i:f(b)+b.offsetHeight)<=f(a)-c}()||function(){return(b===window?i:f(b))>=f(a)+c+a.offsetHeight}()||function(){return(b===window?d()+window.pageXOffset:g(b)+d())<=g(a)-c}()||function(){return(b===window?j:g(b))>=g(a)+c+a.offsetWidth}())}_setSourcesForPicture(a,b){const c=a.parentElement;if("PICTURE"===c.tagName)for(let a=0;a<c.children.length;a++){let d=c.children[a];if("SOURCE"===d.tagName){let a=d.getAttribute("data-"+b);a&&d.setAttribute("srcset",a)}}}_setSources(a,b,c){const d=a.tagName,e=a.getAttribute("data-"+c);if("IMG"===d){this._setSourcesForPicture(a,b);const c=a.getAttribute("data-"+b);return c&&a.setAttribute("srcset",c),void(e&&a.setAttribute("src",e))}if("IFRAME"===d)return void(e&&a.setAttribute("src",e));e&&(a.style.backgroundImage="url("+e+")")}_showOnAppear(a){function b(){a.removeEventListener("load",c),a.classList.remove(d.class_loading),d.callback_error&&d.callback_error(a)}function c(){null!==d&&(d.callback_load&&d.callback_load(a),a.classList.remove(d.class_loading),a.classList.add(d.class_loaded),a.removeEventListener("load",c),a.removeEventListener("error",b))}const d=this._settings;"IMG"!==a.tagName&&"IFRAME"!==a.tagName||(a.addEventListener("load",c),a.addEventListener("error",b),a.classList.add(d.class_loading)),this._setSources(a,d.data_srcset,d.data_src),d.callback_set&&d.callback_set(a)}_loopThroughElements(){const a=this._settings,b=this._elements,c=b?b.length:0;let d,e=[];for(d=0;d<c;d++){let c=b[d];a.skip_invisible&&null===c.offsetParent||this._isInsideViewport(c,a.container,a.threshold)&&(this._showOnAppear(c),e.push(d),c.wasProcessed=!0)}for(;e.length>0;)b.splice(e.pop(),1),a.callback_processed&&a.callback_processed(b.length);0===c&&this._stopScrollHandler()}_purgeElements(){const a=this._elements,b=a.length;let c,d=[];for(c=0;c<b;c++){let b=a[c];b.wasProcessed&&d.push(c)}for(;d.length>0;)a.splice(d.pop(),1)}_startScrollHandler(){this._isHandlingScroll||(this._isHandlingScroll=!0,this._settings.container.addEventListener("scroll",this._boundHandleScroll))}_stopScrollHandler(){this._isHandlingScroll&&(this._isHandlingScroll=!1,this._settings.container.removeEventListener("scroll",this._boundHandleScroll))}handleScroll(){const a=this._settings.throttle;if(0!==a){const b=()=>{(new Date).getTime()};let c=b(),d=a-(c-this._previousLoopTime);d<=0||d>a?(this._loopTimeout&&(clearTimeout(this._loopTimeout),this._loopTimeout=null),this._previousLoopTime=c,this._loopThroughElements()):this._loopTimeout||(this._loopTimeout=setTimeout(function(){this._previousLoopTime=b(),this._loopTimeout=null,this._loopThroughElements()}.bind(this),d))}else this._loopThroughElements()}update(){this._elements=Array.prototype.slice.call(this._queryOriginNode.querySelectorAll(this._settings.elements_selector)),this._purgeElements(),this._loopThroughElements(),this._startScrollHandler()}destroy(){window.removeEventListener("resize",this._boundHandleScroll),this._loopTimeout&&(clearTimeout(this._loopTimeout),this._loopTimeout=null),this._stopScrollHandler(),this._elements=null,this._queryOriginNode=null,this._settings=null}}return a});
//# sourceMappingURL=lazyload.min.js.map